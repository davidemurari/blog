<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.242">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Davide Murari - Numerical conservation of quadratic first integrals</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-listing/list.min.js"></script>
<script src="../site_libs/quarto-listing/quarto-listing.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>

  window.document.addEventListener("DOMContentLoaded", function (_event) {
    const listingTargetEl = window.document.querySelector('#listing-listing .list');
    if (!listingTargetEl) {
      // No listing discovered, do not attach.
      return; 
    }

    const options = {
      valueNames: ['listing-toc','listing-date','listing-author','listing-categories',{ data: ['index'] },{ data: ['categories'] },{ data: ['listing-date-sort'] },{ data: ['listing-file-modified-sort'] }],
      
      searchColumns: ["listing-toc","listing-date","listing-author","listing-categories"],
    };

    window['quarto-listings'] = window['quarto-listings'] || {};
    window['quarto-listings']['listing-listing'] = new List('listing-listing', options);

    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  });

  window.addEventListener('hashchange',() => {
    if (window['quarto-listing-loaded']) {
      window['quarto-listing-loaded']();
    }
  })
  </script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Davide Murari</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/davidemurari"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/dademurari"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html">
 <span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../academicWork.html">
 <span class="menu-text">Academic work</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Numerical conservation of quadratic first integrals</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction-to-the-problem" id="toc-introduction-to-the-problem" class="nav-link active" data-scroll-target="#introduction-to-the-problem">Introduction to the problem</a></li>
  <li><a href="#conditions-on-classical-rungekutta-methods" id="toc-conditions-on-classical-rungekutta-methods" class="nav-link" data-scroll-target="#conditions-on-classical-rungekutta-methods">Conditions on classical Runge–Kutta methods</a></li>
  <li><a href="#preserve-quadratic-invariants-with-modifications-of-explicit-rungekutta-methods" id="toc-preserve-quadratic-invariants-with-modifications-of-explicit-rungekutta-methods" class="nav-link" data-scroll-target="#preserve-quadratic-invariants-with-modifications-of-explicit-rungekutta-methods">Preserve quadratic invariants with modifications of explicit Runge–Kutta methods</a></li>
  <li><a href="#lie-group-methods" id="toc-lie-group-methods" class="nav-link" data-scroll-target="#lie-group-methods">Lie group methods</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction-to-the-problem" class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-the-problem">Introduction to the problem</h2>
<p>Real-world physical systems can be usually modelled by systems of ordinary differential equations (ODEs) in some Euclidean space <span class="math inline">\(\mathbb{R}^n\)</span> or on some embedded submanifold <span class="math inline">\(\mathcal{M}\subset\mathbb{R}^n\)</span>. The solutions of these ODEs can also be geometrically characterized as integral curves of some vector field <span class="math inline">\(X\in\mathfrak{X}(\mathbb{R}^n)\)</span> or <span class="math inline">\(X\in\mathfrak{X}(\mathcal{M})\)</span>. Here, by integral curves, we mean curves to which <span class="math inline">\(X\)</span> is pointwise tangent. These systems usually can not be solved analytically, but such solutions can be approximated using some numerical integrator, for example, the simple explicit-Euler method. More often than not, physical systems also have some characteristic properties. For example, they can conserve some energy function, or be Hamiltonian, or be the gradient of some scalar function. When this is the case, it might be relevant to reproduce such behaviour even in the numerical approximation of its solutions. The area of numerical analysis that focuses on this last aspect is usually called “Geometric numerical integration”. In this post we will focus on the specific case in which a vector field <span class="math inline">\(X\in\mathfrak{X}(\mathbb{R}^n)\)</span> preserves the spheres <span class="math inline">\(S^{n-1}\subset\mathbb{R}^n\)</span> or, in other words, has <span class="math inline">\(I(x) = |x|^2\)</span> as a conserved quantity. Vector fields satisfying this property are all and only those satisfying <span class="math inline">\(\nabla I(x)^T X(x) = 2x^TX(x)=0\)</span>, i.e.&nbsp;they are pointwise orthogonal to <span class="math inline">\(x\in\mathbb{R}^n\)</span>. This article covers some numerical approaches reproducing this behaviour in the discrete solution. One of the reported solutions involves implicit numerical methods, while two others can be based on explicit Runge–Kutta methods. I want to highlight that these 3 strategies are by no means the only ones known. For example, a relevant family of integrators that I do not discuss are projection methods.</p>
</section>
<section id="conditions-on-classical-rungekutta-methods" class="level2">
<h2 class="anchored" data-anchor-id="conditions-on-classical-rungekutta-methods">Conditions on classical Runge–Kutta methods</h2>
<p>A classical Runge–Kutta method of <span class="math inline">\(s-\)</span>stages, is characterized by a matrix <span class="math inline">\(A\in\mathbb{R}^{s\times s}\)</span> and two vectors <span class="math inline">\(b,c\in\mathbb{R}^n\)</span> that together define the Butcher’s tableau of the method. The way in which these 3 elements are involved for the solution approximation of <span class="math inline">\(X\in\mathfrak{X}(\mathbb{R}^n)\)</span>, is determined by the following discrete update: <span class="math display">\[x_{k+1}= \varphi_h(x_k) = x_k + h \sum_{i=1}^s b_i X(x_{k,i}), \,\, x_{k,i} = x_k + h\sum_{j=1}^{i-1} a_{ij} X(x_{k,j}).\]</span> Since we are considering autonomous dynamical systems, the <span class="math inline">\(c\)</span> vector is not involved here. This family of numerical integrators can preserve all linear first integrals; however, not all the methods can preserve all quadratic first integrals. For this to happen, there has to be a specific algebraic relation between <span class="math inline">\(A\)</span> and <span class="math inline">\(b\)</span>. We first introduce it and then prove that the Runge–Kutta method preserves the desired conserved quantity with this structure. Let <span class="math inline">\(B\)</span> be the diagonal matrix having <span class="math inline">\(b\)</span> on the diagonal. Then, a Runge–Kutta method of Tableau <span class="math inline">\((A,b,c)\)</span> preserves all the quadratic first integrals of <span class="math inline">\(X\)</span> if and only if <span class="math display">\[ A^TB+BA-bb^T=0. \]</span> This relation can be translated into <span class="math inline">\(a_{ij}b_i + a_{ji}b_j - b_ib_j = 0\)</span> for any <span class="math inline">\(i,j=1,...,s\)</span>. We now prove this fact, but first, we notice that this can not be true if <span class="math inline">\(A\)</span> is lower triangular, i.e.&nbsp;if the Runge–Kutta method is explicit. For simplicity, we restrict to the first integral <span class="math inline">\(I(x)=\|x\|^2\)</span>; however, the same reasoning can be extended to <span class="math inline">\(I_S(x)=x^TSx\)</span> for every symmetric and positive semi-definite matrix <span class="math inline">\(S\)</span>. Since the problem we consider is autonomous, to achieve what we want is enough to check that <span class="math inline">\(I(x_1)=I(x_0)\)</span>: <span class="math display">\[
\begin{split}
I(x_1) &amp;= x_1^Tx_1 = \langle x_0 + h\sum_{i=1}^s b_i X(x_{0,i}), x_0 + h\sum_{j=1}^s b_j X(x_{0,j}) \rangle \\
&amp;=I(x_0) + 2h\sum_{i}b_{i}\langle x_0 ,X(x_{0,i}) \rangle + h^2\sum_{i,j}b_ib_j\langle X(x_{0,i}),X(x_{0,j}) \rangle
\end{split}
\]</span> We now introduce, with a simple trick, the terms <span class="math inline">\(a_{ij}\)</span>. Indeed, we recall <span class="math display">\[
x_{0,i} = x_0 + h\sum_{j=1}^s a_{ij}X(x_{0,j})\implies x_0 = x_{0,i}-h\sum_{j}a_{ij}X(x_{0,j}).
\]</span> We hence replace this expression, in place of <span class="math inline">\(x_{0}\)</span> in the previously obtained result: <span class="math display">\[
\begin{split}
I(x_1) &amp;= I(x_0) + 2h\sum_{i}b_{i}\langle x_{0,i}-h\sum_{j}a_{ij}X(x_{0,j}) ,X(x_{0,i}) \rangle +\\ &amp;+h^2\sum_{i,j}b_ib_j\langle X(x_{0,i}),X(x_{0,j}) \rangle = \\
&amp;= I(x_0) - 2h^2 \sum_{i,j}b_ia_{ij}\langle X(x_{0,j}).X(x_{0,i})\rangle + h^2\sum_{i,j}b_ib_j\langle X(x_{0,i}),X(x_{0,j}) \rangle .
\end{split}
\]</span> Here, one term vanished because <span class="math inline">\(\nabla I(z)^TX(z)=z^TX(z)=0\)</span> for any <span class="math inline">\(z\)</span>. We then can conclude noticing that this expression can be rewritten as follows <span class="math display">\[
I(x_1) = I(x_0) - h^2 \sum_{i,j} \left(b_ia_{ij}+b_ja_{ji}-b_ib_j\right)\langle X(x_{0,i}),X(x_{0,j}) \rangle = I(x_0)
\]</span> by splitting the first term into two equal parts and exchanging (in one of them) the <span class="math inline">\(i\)</span> with the <span class="math inline">\(j\)</span>. A simple example of a Runge–Kutta method that satisfies this property is the implicit Mid-Point method, a <span class="math inline">\(1-\)</span>stage method with Tableau <span class="math inline">\(A=c=1/2\)</span>, <span class="math inline">\(b=1\)</span>. Thus <span class="math display">\[
A^TB+BA-bb^T = \frac{1}{2}+\frac{1}{2}-1 = 0
\]</span> as desired.</p>
</section>
<section id="preserve-quadratic-invariants-with-modifications-of-explicit-rungekutta-methods" class="level2">
<h2 class="anchored" data-anchor-id="preserve-quadratic-invariants-with-modifications-of-explicit-rungekutta-methods">Preserve quadratic invariants with modifications of explicit Runge–Kutta methods</h2>
<p>All the Runge–Kutta methods that satisfy the condition introduced in the previous section have to be implicit. Sometimes, it is not desirable to use implicit methods; however, one might still be interested in preserving quadratic invariants, as <span class="math inline">\(|x|^2\)</span>. In this section, we briefly go through a result introduced in the paper [1], where a more general theory is also developed. Consider an explicit Runge–Kutta method with <span class="math inline">\(s\)</span> stages <span class="math display">\[x_{k+1}= \varphi_h(x_k) = x_k + h \sum_{i=1}^s b_i X(x_{k,i})\]</span> with <span class="math display">\[ x_{k,i} = x_k + h\sum_{j=1}^{i-1} a_{ij} X(x_{k,j})\]</span> being the internal stages. It is simple to notice that in general <span class="math inline">\(|\varphi_h(x_k)|^2\neq |x_k|^2\)</span> and hence that the quadratic first integral of <span class="math inline">\(X\)</span> is not discretely preserved. The question is now: how can we slightly modify <span class="math inline">\(\varphi_h\)</span> to preserve <span class="math inline">\(|x|^2\)</span> still getting a consistent approximation of the analytical solution? To do so, we introduce can a scalar value <span class="math inline">\(\gamma_k\)</span> as <span class="math display">\[\tilde{\varphi}_h (x_k) = (1-\gamma_k)\varphi_h(x_k) + \gamma_k x_k.\]</span> By replacing <span class="math display">\[\gamma_k = \frac{|\varphi_h(x_k)|^2 - |x_k|^2}{|\varphi_h(x_k)-x_k|^2}\]</span> in the previous expression, one can verify that <span class="math inline">\(|x|^2\)</span> will be preserved by <span class="math inline">\(\tilde{\varphi}_h\)</span>. Moreover, it is possible to prove that if the base method <span class="math inline">\(\varphi_h\)</span> has order <span class="math inline">\(p\geq 2\)</span>, the perturbation <span class="math inline">\(\tilde{\varphi}_h\)</span> will have order <span class="math inline">\(p-1\)</span>. It is important to remark that this construction is based on one assumption on <span class="math inline">\(\varphi_h\)</span>. Indeed, call <span class="math inline">\(h\Delta_k = \varphi_h(x_k) - x_k\)</span>, then we suppose <span class="math display">\[\langle x_k, \Delta_k\rangle \cdot \langle \Delta_k,\Delta_k\rangle\neq 0.\]</span> This, for example, says that the construction is not well defined for explicit-Euler where <span class="math inline">\(\Delta_k = X(x_k)\)</span> and it hence holds <span class="math inline">\(\langle \Delta_k , x_k\rangle = 0\)</span> since <span class="math inline">\(|x|^2\)</span> is a first integral of <span class="math inline">\(X\)</span>. An example for which this reasoning can be applied is the Euler-Heun method of order 2. Such a method writes <span class="math display">\[
\quad x_{n,2} = x_n + h X(x_n),\quad x_{n+1} = x_n + \frac{h}{2}\left(X(x_n) + X(x_{n,2})\right) = \varphi_h(x_n)
\]</span> and the modification <span class="math inline">\(\tilde{\varphi}_h\)</span> can be defined as above. I applied such a modified Euler-Heun method to the simple linear ODE <span class="math inline">\(\dot{x}(t) = (B-B^T)x(t) = X(x(t))\)</span>, where <span class="math inline">\(B\)</span> is a randomly generated matrix. This vector field preserves the function <span class="math inline">\(|x|^2\)</span> and we see from the plots below that also the numerical solution does it when computed with <span class="math inline">\(\tilde{\varphi}_h\)</span>. As a comparison, I report the plot also for the classical Runge–Kutta method of order 4, based on the default implementation in SciPy of Python.</p>
</section>
<section id="lie-group-methods" class="level2">
<h2 class="anchored" data-anchor-id="lie-group-methods">Lie group methods</h2>
<p>In this last section, we are briefly going through a third possible solution to the problem of preserving the first integral <span class="math inline">\(I(x)=\|x\|^2\)</span>. The term “Lie group methods” encapsulates a lot of different approaches. If one wants to read more about them, I suggest some references here : [2], [3], [4], [5].</p>
<p>We briefly see the idea and how to transform any Runge-Kutta method into an integrator preserving <span class="math inline">\(I(x)\)</span>. We do this by introducing the notion of homogeneous manifold and of transitive Lie group action.</p>
<p>Given a manifold <span class="math inline">\(\mathcal{M}\)</span>, we say it to be homogeneous if there can be defined a Lie group action <span class="math inline">\(\varphi: G\times \mathcal{M}\rightarrow\mathcal{M}\)</span> that is transitive. With transitive group action, we mean an action that allows moving any point <span class="math inline">\(m\in \mathcal{M}\)</span> into any other <span class="math inline">\(m'\in\mathcal{M}\)</span> through the action of some group element <span class="math inline">\(g\in G\)</span>. More concisely, <span class="math inline">\(\varphi\)</span> is transitive if and only if</p>
<p><span class="math display">\[
\forall m,m'\in\mathcal{M}\,\,\exists g\in G\text{ such that }\varphi(g,m)=m'.
\]</span></p>
<p>The sphere <span class="math inline">\(S_r^2\subset\mathbb{R}^3\)</span> of radius <span class="math inline">\(r&gt;0\)</span> is a simple example of homogeneous manifold. Indeed, let <span class="math inline">\(G=SO(3)\)</span> be the special orthogonal group, made by orthogonal matrices that preserve the orientation, i.e.&nbsp;rotation matrices. Then, we can define</p>
<p><span class="math display">\[
\varphi: SO(3)\times S_r^2 \rightarrow S_r^2,\,\,(R,x)\mapsto Rx.
\]</span></p>
<p>This is a group action since <span class="math inline">\(R=I_3\)</span>, the identity matrix, it sends <span class="math inline">\(x\)</span> into itself. Moreover, we have <span class="math inline">\(\varphi(R_2,\varphi(R_1,x)) = R_2R_1x = \varphi(R_2R_1,x)\)</span>. To check its transitivity, there are various approaches that work. For simplicity, we now work with <span class="math inline">\(S_r^2\)</span> embedded in <span class="math inline">\(\mathbb{R}^3\)</span>, i.e.&nbsp;<span class="math inline">\(S^2_r = \{g^{-1}(\{0\}):\, g(x)=\|x\|^2-r,\,x\in\mathbb{R}^3\}\)</span>, use the coordinates of the ambient space and set <span class="math inline">\(r=1\)</span> denoting <span class="math inline">\(S^2_1=S^2\)</span>. We then show that <span class="math inline">\(e_1=(1,0,0)\in S^2\)</span> can be sent to any point <span class="math inline">\(v\in S^2\)</span> thanks to some rotation matrix <span class="math inline">\(M_v\in SO(3)\)</span>. From this, to prove that for any pair <span class="math inline">\(x,y\in S^2\)</span> there exists <span class="math inline">\(R_{xy}\in SO(3)\)</span> so that <span class="math inline">\(R_{xy}x = y\)</span>, we can simply set <span class="math inline">\(R_{xy} = M_yM_x^{-1}\)</span>. Indeed, <span class="math inline">\(R_{xy}x = M_yM_x^{-1}x=M_ye_1=y\)</span> as desired.</p>
<p>To build this <span class="math inline">\(M_v\)</span>, we can define the vector <span class="math inline">\(v\in S^2\subset\mathbb{R}^3\)</span> in terms of its ambient space coordinates <span class="math inline">\(v=(v_x,v_y,v_z)\in\mathbb{R}^3\)</span>. Then, we see that if&nbsp; <span class="math inline">\(M_ve_1=v\)</span>, necessarily the first column of <span class="math inline">\(M_v\)</span> has to be <span class="math inline">\(v\)</span>. Then, we just have to complete <span class="math inline">\(M_v\)</span> to an orthogonal matrix with two other orthonormal vectors as second and third columns. The extension to a generic radius <span class="math inline">\(r&gt;0\)</span> is immediate.</p>
<p>The reason why <span class="math inline">\(S_r^2\)</span> matters, in the preservation of <span class="math inline">\(I(x)\)</span>, is that when a vector field <span class="math inline">\(X\in\mathbb{R}^3\)</span> has <span class="math inline">\(I\)</span> as a conserved quantity, it is tangent to the spheres of <span class="math inline">\(\mathbb{R}^3\)</span>. Indeed, having a conserved quantity <span class="math inline">\(I\)</span> for a dynamics means that such a dynamics preserves the level sets of <span class="math inline">\(I\)</span>. The level sets of <span class="math inline">\(I(x)\)</span> are spheres of radius <span class="math inline">\(r\)</span> determined by the initial condition. In other&nbsp; words, we have that</p>
<p><span class="math display">\[
x_0\in S_r^2 \implies x(t) \in S^2_r\,\forall t\geq 0
\]</span></p>
<p>if</p>
<p><span class="math display">\[
\begin{cases}
\dot{x}(t) = X(x(t)),\\
x(0) = x_0.
\end{cases}
\]</span></p>
<p>A Lie group <span class="math inline">\(G\)</span> can be associated with its Lie algebra <span class="math inline">\(\mathfrak{g}\simeq T_e G\)</span>. To map objects in <span class="math inline">\(\mathfrak{g}\)</span> to those in <span class="math inline">\(G\)</span>, there are various mappings available, however, we now focus on the exponential map <span class="math inline">\(\exp:\mathfrak{g}\rightarrow G\)</span> that is a local diffemorphism about the identity element of <span class="math inline">\(G\)</span>.&nbsp; For matrix Lie groups, this is simply the matrix exponential</p>
<p><span class="math display">\[
\exp(A) = \sum_{k=0}^{+\infty}\frac{A^k}{k!}.
\]</span></p>
<p>The Lie algebra of <span class="math inline">\(SO(3)\)</span>, denoted with <span class="math inline">\(\mathfrak{so}(3)\)</span>, is the vector space of skew-symmetric matrices. Indeed, we have that for any matrix <span class="math inline">\(A=B-B^T\in\mathfrak{so}(3)\)</span>,</p>
<p><span class="math display">\[
\exp(A)\in SO(3).
\]</span></p>
<p>The main idea of one class of Lie group integrators is to locally transfer the dynamics from the homogeneous manifold <span class="math inline">\(\mathcal{M}\)</span> to the Lie algebra <span class="math inline">\(\mathfrak{g}\)</span> of the Lie group <span class="math inline">\(G\)</span> acting transitively on it. On this linear space <span class="math inline">\(\mathfrak{g}\)</span> we then perform one time-step with some Runge–Kutta method and then bring such updated position back to <span class="math inline">\(\mathcal{M}\)</span>. To work with this framework with an arbitrary Runge–Kutta method, we would need a more detailed presentation, however, for explicit-Euler, this can be seen in a quite simple way.</p>
<p>The most difficult task among those presented in the previous paragraph is the one of lifting/transferring the dynamics on the Lie algebra. This is done thanks to the infinitesimal generator of the group action <span class="math inline">\(\varphi\)</span> defined as</p>
<p><span class="math display">\[
\varphi_*(\xi)(x) = \frac{d}{d\varepsilon}\Big\vert_{\varepsilon=0}\varphi(\exp(t\xi),x)
\]</span></p>
<p>where <span class="math inline">\(\xi\in\mathfrak{g}\)</span> and <span class="math inline">\(x\in\mathcal{M}\)</span>. Because of the transitivity of the group action, it can be proven that <span class="math inline">\(\forall Y\in\mathfrak{X}(\mathcal{M})\)</span>, there is a function <span class="math inline">\(f_Y:\mathcal{M}\rightarrow \mathfrak{g}\)</span> such that</p>
<p><span class="math display">\[
\varphi_*(f_Y(x))(x) = Y(x),\quad \forall x\in\mathcal{M}.
\]</span></p>
<p>For the sake of completeness, I write the lifted ODE on <span class="math inline">\(\mathfrak{g}\)</span> coming from this function we have just introduced. However, this expression simplifies considerably when we are just interested in one step with explicit-Euler method.</p>
<p><span class="math display">\[
\begin{cases}
\dot{\xi}(t) = d\exp_{\xi(t)}^{-1}\circ f \circ \varphi(\exp(\xi(t)),x)\in T_{\xi(t)}\mathfrak{g},\\
\xi(0) = 0.
\end{cases}
\]</span></p>
<p>The idea of some Lie group methods is hence to perform one time step of this ODE with some Runge–Kutta method to get an approximation <span class="math inline">\(\xi_1\approx \xi(h)\)</span>. Then, we can use it to update the position of <span class="math inline">\(x\)</span> on <span class="math inline">\(\mathcal{M}\)</span> as</p>
<p><span class="math display">\[
x' = \varphi(\exp(\xi_1),x).
\]</span></p>
<p>Using explicit-Euler as the Runge–Kutta method of choice, we have that</p>
<p><span class="math display">\[
\xi_1 = 0 + h d\exp_{0}^{-1}\circ f \circ \varphi(\exp(0),x) = hf(x).
\]</span></p>
<p>Thus, we get the so-called Lie-Euler method as</p>
<p><span class="math display">\[
x' = \varphi(\exp(hf(x)),x).
\]</span></p>
<p>As a test case, we apply it to the free-rigid body equation that writes</p>
<p><span class="math display">\[
\dot{z}(t) = z(t) \times I^{-1}z(t) = X(z(t)),\quad \text{with }I = diag(I_1,I_2,I_3).
\]</span></p>
<p>It is immediate to notice that <span class="math inline">\(z^TX=0\)</span> for any <span class="math inline">\(x\)</span>, by the properties of the <span class="math inline">\(\mathbb{R}^3\)</span> cross-product. <span class="math inline">\(\times\)</span>.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>[1] Calvo, M., Hernández-Abreu, D., Montijano, J. I., &amp; Rández, L. (2006). On the preservation of invariants by explicit Runge–Kutta methods. SIAM Journal on Scientific Computing, 28(3), 868-885.</p>
<p>[2] Iserles, A., Munthe-Kaas, H. Z., Nørsett, S. P., &amp; Zanna, A. (2000). Lie-group methods.&nbsp;Acta numerica,&nbsp;9, 215-365.</p>
<p>[3] Celledoni, E., Marthinsen, H., &amp; Owren, B. (2014). An introduction to Lie group integrators–basics, new developments and applications.&nbsp;Journal of Computational Physics,&nbsp;257, 1040-1061.</p>
<p>[4] Celledoni, E., Çokaj, E., Leone, A., Murari, D., &amp; Owren, B. (2022). Lie Group integrators for mechanical systems.&nbsp;International Journal of Computer Mathematics,&nbsp;99(1), 58-88.</p>
<p>[5] Owren, B. (2018). Lie group integrators. In&nbsp;Discrete Mechanics, Geometric Integration and Lie–Butcher Series&nbsp;(pp.&nbsp;29-69). Springer, Cham.</p>



</section>

<div class="quarto-listing quarto-listing-container-default" id="listing-listing">
<div class="list quarto-listing-default">
<div class="quarto-post image-right" data-index="0" data-categories="Geometric integration" data-listing-date-sort="1665871200000">
<div class="body">
<a href=""> </a>
<div class="listing-categories">
<div class="listing-category" onclick="window.quartoListingCategory('Geometric integration'); return false;">
Geometric integration
</div>
</div>
<a href=""> </a>
</div>
<div class="metadata">
<a href="">
<div class="listing-date">
Oct 16, 2022
</div>
<div class="listing-author">
Davide Murari
</div>
<div class="metadata-value listing-toc">
true
</div>
</a>
</div>
</div>
</div>
<div class="listing-no-matching d-none">
No matching items
</div>
</div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>